language: c++

before_script:
    - mkdir build ; cd build
    - CC=clang-6.0 CXX=clang++-6.0 cmake .. -G "Unix Makefiles" -DLLVM_TARGETS_TO_BUILD="X86" -DCMAKE_BUILD_TYPE=Release -DLLVM_BUILD_RUNTIME=OFF  -DLLVM_BUILD_TOOLS=OFF  -DLLVM_INCLUDE_DOCS=OFF -DLLVM_INCLUDE_EXAMPLES=OFF

script:
    - make -j4

after_script:
    - cd build
    - tar -czf llvmlibs-linux.tar.gz lib include
    # Actually deploy now
    - wget -c https://github.com/probonopd/uploadtool/raw/master/upload.sh
    - chmod +x ./upload.sh
    - export UPLOADTOOL_SUFFIX=linux-${TRAVIS_BRANCH}
    - ./upload.sh ./llvmlibs-linux.tar.gz
addons:
    apt:
        sources:
            - ubuntu-toolchain-r-test
            - llvm-toolchain-trusty-6.0
        packages:
            - cmake
            - libstdc++-5-dev
            - clang-6.0
            - ninja-build
